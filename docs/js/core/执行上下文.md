---
slug: execution context
tags: [js-core]
---

## [JavaScript Execution Context](https://www.javascripttutorial.net/javascript-execution-context/)
:::tip
- [Execution Contexts](https://tc39.es/ecma262/#sec-execution-contexts)
- [JavaScript Execution Context – How JS Works Behind The Scenes](https://www.freecodecamp.org/news/execution-context-how-javascript-works-behind-the-scenes/)
- [Javascript Execution Context and Hoisting](https://levelup.gitconnected.com/javascript-execution-context-and-hoisting-c2cc4993e37d)
- [JavaScript Execution Context](https://www.javascripttutorial.net/javascript-execution-context/)

:::

- When the JavaScript engine executes the JavaScript code, it creates execution contexts.

- Each execution context has two phases: the creation phase and the execution phase. 创建阶段 和 执行阶段

### 1. The creation phase 创建阶段
:::tip
**When the JavaScript engine executes a script for the first time, it creates the global execution context.** During this phase, the JavaScript engine performs the following tasks:
- Create the `global object` i.e., `window` in the web browser or `global` in Node.js.

- Create the `this` object and bind it to the global object.

- Setup a memory heap for storing variables and function references.

- Store the function declarations in the memory heap and variables within the global execution context with the initial values as `undefined`.
:::

```js
let x = 10;

function timesTen(a) {
  return a * 10;
}

let y = timesTen(x);

console.log(y); // 100
```
When the JavaScript engine executes the code example above, it does the following in the creation phase:
- First, store the variables `x` and `y` and function declaration `timesTen()` in the global execution context.

- Second, initialize the variables `x` and `y` to `undefined`.

![global execution context](../img/global-execution-context-in-creation-phase.png)

### 2. The execution phase 执行阶段
During the execution phase, the JavaScript engine executes the code line by line, assigns the values to variables, and executes the function calls.

![global execution context](../img/global-execution-context-in-execution-phase.png)

**For each function call, the JavaScript engine creates a new function execution context.** JavaScript引擎对每一个函数调用 创建一个新的 函数执行上下文。

The function execution context is similar to the global execution context. But instead of creating the global object, the JavaScript engine creates the `arguments` object that is a reference to all the parameters of the function.
```js
function timesTen(a) {
  return a * 10;
}
```
The function execution context creates the `arguments` object that references all parameters passed into the function, sets `this` value to the global object, and initializes the `a` parameter to `undefined`.

![function execution context](../img/function-execution-context-in-creation-phase.png)

During the execution phase of the function execution context, the JavaScript engine assigns `10` to the parameter `a` and returns the result (100) to the global execution context.

![function execution context](../img/function-execution-context-in-execution-phase.png)

:::tip
To keep track of all the execution contexts, including the global execution context and function execution contexts, the JavaScript engine uses the `call stack`.
:::